## this.exportDataObject를 악용한 파일 drop

OpenAction은 pdf 파일을 열었을 때의 action을 결정함.

![](images/pdf/IMG-pdf-20240910225355042.png)

OpenAction은 object 9에, eicar-dropper.doc라는 임베디드 파일은 object 7에 관련 정보가 존재. OpenAction 관련 정보를 얻기 위해 object 9를 확인.

![](images/pdf/IMG-pdf-20240910225346098.png)

pdf 파일 내에 존재하는 첨부 파일을 저장 및 실행하는 `this.exportDataObject` 명령어가 존재.

```javascript
this.exportDataObject({
    cName: "첨부파일이름",
    nLaunch: 0 
});

// cName: PDF 내에 첨부된 파일 이름
// nLaunch: 내보낸 파일을 자동으로 여는 옵션 
//   0: 파일 저장 (사용자가 지정한 저장 경로)
//   1: 파일 저장 및 실행 (사용자가 지정한 저장 경로)
//   2: 파일 저장 및 실행 (임시경로에 저장, 사용자에게 저장경로를 묻지 않음)
```

acrobat으로 해당 파일을 열었을 시, 다음과 같은 알림창이 활성화되는데 OK를 누르면 첨부파일이 자동으로 저장 및 실행됨.

![](images/pdf/IMG-pdf-20240910225211959.png)
