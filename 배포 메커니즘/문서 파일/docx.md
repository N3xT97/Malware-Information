## docx

- Microsoft Word에서 만든 문서를 만들고 저장하는 데 사용되는 파일 형식
- Microsoft Word 버전 2007 이상의 기본 파일 형식이며 이전 DOC 파일 형식을 대체
- ML과 ZIP 압축이 결합된 Open XML 파일 형식을 기반
- 압축 해제를 통해 내부 내용을 확인할 수 있음.
	
	![399](../../../Malware%20Analysis%20Guide/분석%20가이드/기본%20가이드/images/docx%20분석%20(template%20injection,%20vba%20macros)/IMG-docx%20분석%20(template%20injection,%20vba%20macros)-20240910114712389.png)
	

### \\word\\media\\

- 악성 코드에서는 정상적인 파일로 보이게 하기 위해 이미지를 활용하는 경우가 존재
	
	![399](../../../Malware%20Analysis%20Guide/분석%20가이드/기본%20가이드/images/docx%20분석%20(template%20injection,%20vba%20macros)/IMG-docx%20분석%20(template%20injection,%20vba%20macros)-20240910114712501.png)
	
- 해당 폴더에서는 docx 파일에 사용된 image를 확인 가능
	
	![439](../../../Malware%20Analysis%20Guide/분석%20가이드/기본%20가이드/images/docx%20분석%20(template%20injection,%20vba%20macros)/IMG-docx%20분석%20(template%20injection,%20vba%20macros)-20240910114712601.png)
	

### \\word\\\_rels\\settings.xml.rels

- 공격자는 settings.xml.rels 내의 Target 중 하나를 Injection 하고자하는 파일의 위치로 변경.
	
	![556](../../../Malware%20Analysis%20Guide/분석%20가이드/기본%20가이드/images/docx%20분석%20(template%20injection,%20vba%20macros)/IMG-docx%20분석%20(template%20injection,%20vba%20macros)-20240910114712722.png)
	


## Attacks

### Template Injection

1. 사용자가 문서 파일을 실행
2. 외부에서 공격자가 설정한 .dotm 파일이 다운로드됨. (Template Injection)
3. .dotm 파일은 일반적으로 VBA 매크로에 의해 악성 코드를 다운로드하고 실행.