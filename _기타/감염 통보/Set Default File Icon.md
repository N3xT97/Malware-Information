### Concept

랜섬웨어가 암호화 파일의 default file icon을 설정할때 사용됨

### Code Flow

1. `HKEY_CLASSES_ROOT/(.extention)` 레지스트리 키 생성
2. `HKEY_CLASSES_ROOT/(.extention)/DefaultIcon` 레지스트리 키 생성
3. SHChangeNotify를 호출하여 적용될 때까지 대기

### SHChangeNotify
```C++
void SHChangeNotify(
                 LONG    wEventId,
                 UINT    uFlags,
  [in, optional] LPCVOID dwItem1,
  [in, optional] LPCVOID dwItem2
);
```

#### SHCNF_FLUSH
영향을 받는 모든 구성 요소에 알림이 전달될 때까지 함수가 반환되지 않아야 합니다. 이 플래그는 다른 데이터 형식 플래그를 수정하므로 자체에서 사용할 수 없습니다.

### Example

```C++
RegCreateKeyExW(HKEY_CLASSES_ROOT, ".example", 0x0, 0x0, 0x0,
				KEY_WRITE|KEY_WOW64_64KEY, 0x0, &h_key, 0x0);
len = wcslen("example");
RegSetValueExW(h_key, "", 0x0, REG_SZ, "example", (len + 0x1) * 2);
ZwClose(h_key);

RegCreateKeyExW(HKEY_CLASSES_ROOT,".example\\DefaultIcon",0x0,NULL,0x0,
                KEY_WRITE | KEY_WOW64_64KEY,NULL,&h_key,NULL);
len = wcslen("C:\\example_path\\example.ico");
RegSetValueExW(h_key, &reg_value_name, 0x0, 0x1,
			   "C:\\example_path\\example.ico", (len + 0x1) * 0x2);
ZwClose(h_key);

SHChangeNotify(SHCNE_ASSOCCHANGED, SHCNF_FLUSH, 0x0, 0x0);

```
