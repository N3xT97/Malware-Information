### Concept

랜섬웨어는 시스템 감염 사실을 사용자에게 알리기 위해 프린트 기능을 이용하기도 함.

### Code Flow

1. EnumPrintersW API를 사용하여 프린터 정보 획득
2. CreateDCW API를 사용해 윈도우의 프린터 관리자인 WINSPOOL 드라이버 dc를 생성
3. CreateFontIndirectW API를 사용해 font를 생성
4. StartDocW API를 사용해 인쇄 작업 시작
5. StartPage API를 사용해 프린터 드라이버 준비
6. DrawTextA API를 사용해 인쇄
7. EndPage API를 사용해 프린터 드라이버 종료
8. EndDoc API를 사용해 인쇄 작업 종료

### Example

```c++
EnumPrintersW(PRINTER_ENUM_LOCAL, NULL, 0x5, NULL, 0x0, &size, &n_return);
pi = malloc(size);
EnumPrintersW(PRINTER_ENUM_LOCAL, 0x0, 0x5, pi, size, &size, &n_return);
pi_iter = pi;
while (n_return) {
	OpenPrinterW(pi_iter->pPortName, &h_printer, NULL);
	
	size = DocumentPropertiesW(0x0, h_printer, pi_iter->pPortName, 0x0, 0x0, 0x0);
	dm = malloc(size);
	hdc_winspool = CreateDCW("WINSPOOL", pi_iter->pPortName, NULL, dm);
	SetBkMode(hdc_winspool, 0x1);
    SetMapMode(hdc_winspool, 0x1);
    
    lf = memset(hdc_winspool, 0x0, 0x5c);
	lf.lfFaceName = "Consolas";
	log_pixels_y = GetDeviceCaps(hdc_winspool, LOGPIXELSY);
    lf.lfHeight = MulDiv(0x12, log_pixels_y, 0x48);
    lf.lfWeight = 0x384;
    hfont = CreateFontIndirectW(&lf);
    hgdiobj_old = SelectObject(hdc_winspool, hfont);
	
	di.cbSize = 0x14;
    di.lpszDocName = pi_iter->pPortName;
    StartDocW(hdc_winspool, &di);
    StartPage(hdc_winspool);
    rect.right = GetDeviceCaps(hdc_winspool, HORZRES);
    vert = GetDeviceCaps(hdc_winspool, VERTRES);
    rect.bottom = vert;
    DrawTextA(hdc_winspool, print_buf, print_size, &rect, 0x511);
    EndPage(hdc_winspool);
    EndDoc(hdc_winspool);
    SelectObject(hdc_winspool, hgdiobj_old);
    
	DeleteObject(hfont);
    DeleteDC(hdc_winspool);
    ClosePrinter(h_printer);
    
	p_pi_iter = p_pi_iter + 0x1;
    n_return = n_return - 0x1;
}
```