### Concept

랜섬 웨어가 시스템 감염 사실을 사용자에게 알리기 위해 설정하는 경우 존재

### Code Flow

1. CreateCompatibleDC 사용해 CompatibleDC 생성
2. 해상도 획득
3. CreateFontW를 호출해 Font를 생성하여
4. API들을 사용해 text 설정
5. DrawTextW API를 호출하여 text를 작성
6. BitBlt API를 사용해 BMP 데이터 생성
7. 생성된 데이터를 사용해 BMP 파일을 생성
8. 레지스트리에 BMP 파일을 설정

### Example

```c++
hdc_screen = GetDC(NULL);
hdc_mem_screen_wall = CreateCompatibleDC(hdc_screen);
hdc_mem_screen_text = CreateCompatibleDC(hdc_screen);

horz_res = GetDeviceCaps(hdc_screen, HORZRES);
horz = horz_res + 0x1 & 0xfffffffe;
vert_res = GetDeviceCaps(hdc_screen, VERTRES);
vert = vert_res + 0x1 & 0xfffffffe;

log_pixels_x = GetDeviceCaps(hdc_screen, LOGPIXELSX);
hgdiobj_font = CreateFontW((vert / log_pixels_x) * 0x6, 0x0, 0x0, 0x0, FW_BOLD, FALSE,
						   FALSE, FALSE, DEFAULT_CHARSET, OUT_TT_ONLY_PRECIS,
						   CLIP_DEFAULT_PRECIS, PROOF_QUALITY, FF_DONTCARE,uStack_b0);
SelectObject(hdc_mem_screen_text, hgdiobj_font);
GetTextExtentPoint32W(hdc_mem_screen_text, wallpaper_text, wallpaper_text_len, &tag_size);
hbitmap_mem_bm = CreateCompatibleBitmap(hdc_mem_screen_text, horz, vert);
SelectObject(hdc_mem_screen_text, hbitmap_mem_bm);
SetTextColor(hdc_mem_screen_text, rgbWhite);
SetBkMode(hdc_mem_screen_text, OPAQUE);
SetBkColor(hdc_mem_screen_text, rgbBlack);

rc.left = 0x0;
rc.top = (vert >> 0x1) + tag_size.cy * -0x2;
os_flag_00 = stage3::CheckOS();
rc.right = horz;
if (os_flag == "Windows XP") {
  rc.right = (horz >> 0x1) + (horz >> 0x2);
}
rc.bottom = vert;
dt_vert = DrawTextW(hdc_mem_screen_text, wallpaper_text, wallpaper_text_len, &rc, 0x211);

bi.bmiHeader.biSize = 0x28;
bi.bmiHeader.biBitCount = 0x10;
bi.bmiHeader.biCompression = 0x0;
bi.bmiHeader.biWidth = horz;
bi.bmiHeader.biHeight = vert;
bi.bmiHeader.biPlanes = 0x1;
bi.bmiHeader.biSizeImage = horz * vert * 0x2;
hbitmap = CreateDIBSection(hdc_mem_screen_text, &bi, 0x0, &bits, NULL, 0x0);
SelectObject(hdc_mem_screen_wall, hbitmap);
BitBlt(hdc_mem_screen_wall, 0x0, 0x0, bi.bmiHeader.biWidth,
       bi.bmiHeader.biHeight, hdc_mem_screen_wall, 0x0, 0x0, 0xcc0020);

wallpaper_path = "example.bmp";
h_wallpaper_file = CreateFileW(wallpaper_path, 0x40000000, 0x0, NULL, 0x4, 0x80, NULL);
bmp_header.bfType = 0x4d42;
bmp_header.bfOffBits = 0x36;
bmp_header.bfSize = bi.bmiHeader.biSizeImage + 0x36;
bmp_header.bfReserved1 = 0x0;
bmp_header.bfReserved2 = 0x0;
WriteFile(h_wallpaper_file, bmp_header, 0xe, &ret_len, NULL);
WriteFile(h_wallpaper_file, &bi, 0x28, &ret_len, NULL);
WriteFile(h_wallpaper_file, bits, bi.bmiHeader.biSizeImage, &ret_len ,NULL);

RegCreateKeyExW(HKEY_USERS, "(user_sid)\Control_Panel\Desktop", 0x0, 0x0,
				0x0, 0x20106, 0x0, &h_key, 0x0);
RegSetValueExW(h_key, "WallPaper", 0x0, 0x1, wallpaper_path, wallpaper_path_len * 0x2 + 0x2);
RegSetValueExW(h_key, "WallpaperSytle", 0x0, 0x1, "10", 0x2 * 0x2 + 0x2);
SystemParametersInfoW(SPI_SETDESKWALLPAPER, 0x0, wallpaper_path, 0x3);
```