#com
### Concept

악성 코드는 윈도우 서버 내의 dns host name들을 획득하고자 한다.

### Code Flow

1. ADsOpenObject API를 사용하여 `LDAP://rootDSEADs` 객체를 오픈
	- 해당 객체를 오픈하면 해당 도메인의 기본 도메인 컨트롤러가 사용됨
2. ADsBuildEnumerator, ADsEnumerateNext API들을 사용하여 ADs에 속한 컴퓨터들을 순회
3. IADsContainer::Get 메서드를 사용하여 dNSHostName을 사용하여 host명을 획득

### Example

```c++
# 도메인에 속하는 모든 컴퓨터의 dns host name을 획득
CoInitialize(0x0);
# IID_IADs = {FD8256D0-FD15-11CE-ABC4-02608C9E7553}
ADsOpenObject("LDAP://rootDSE", 0x0, 0x0, 0x1, &iid_IADs, &p_IADs);
p_IADs->Get("defaultNamingContext", &default_naming_context); // DC=example,DC=com
wcscat("LDAP://CN=Computers,", default_naming_context);
# IID_IADsContainer = {001677d0-fd16-11ce-abc4-02608c9e7553}
ADsOpenObject("LDAP://CN=Computers,DC=example,DC=com", 0x0, 0x0, 0x1,
              iid_IADsContainer, &p_IADsContainer);

ADsBuildEnumerator(p_IADsContainer, &p_IEnumVARIANT);
while(true) {
    n_ret = 0x0;
    err = ADsEnumerateNext(p_IEnumVARIANT, 0x1, &ad, &n_ret);
    if (err != ERROR_SUCCESS || n_return == 0x0) break;
	
	p_IADsContainer->Get("dNSHostName", &dns_host_name);
	swprintf(dc_dns_host_name_path, "\\%s\" ,dns_host_name);
	dc_dns_host_name_table = dc_dns_host_name_path;
	
	n_table = n_table + 0x1;
	dc_dns_host_name_table = dc_dns_host_name_table + 0x1;
}
```