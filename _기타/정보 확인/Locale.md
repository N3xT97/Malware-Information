## LCID Ref

ğŸ”— [***Windows Language Code Identifier (LCID) Reference***](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/70feba9f-294e-491e-b6eb-56532684c37f)


## GetKeyboardLayoutList

### Concept

- `GetKeyboardLayoutList`
	- nBuffë¥¼ 0ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ í˜„ì¬ ì‹œìŠ¤í…œì— ì„¤ì¹˜ë˜ì–´ ìˆëŠ” KeyboardLayoutì˜ ê°œìˆ˜ë¥¼ ë°˜í™˜.
	- ë°˜í™˜ëœ nBuffë¥¼ ì‚¬ìš©í•˜ì—¬ GetKeyboardLayoutListë¥¼ í˜¸ì¶œí•˜ë©´ KeyboardLayoutListë¥¼ ë°˜í™˜.
- ì‹¤í–‰ íë¦„
	1. nBuffë¥¼ 0ìœ¼ë¡œ GetKeyboardLayoutListë¥¼ í˜¸ì¶œí•˜ì—¬ KeyboardLayoutì˜ ê°œìˆ˜ë¥¼ íšë“.
	2. ë°˜í™˜ëœ nBuffë¥¼ ì‚¬ìš©í•˜ì—¬ GetKeyboardLayoutListë¥¼ í˜¸ì¶œí•˜ì—¬ KeyboardLayoutListë¥¼ íšë“.
	3. ë°˜í™˜ëœ KeyboardLayoutListë¥¼ ìˆœíšŒí•˜ë©° Target LCIDê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸.

### GetKeyboardLayoutList

```C++
int GetKeyboardLayoutList(
  [in]  int nBuff,
  [out] HKL *lpList
);
```

### Example

```C++
n_kb_list = GetKeyboardLayoutList(0x0,NULL);
HKB *p_kb_list = NULL;
p_kb_list = malloc(sizeof(HKL) * nKBList);
n_kb_list = GetKeyboardLayoutList(nKBList,pKBList);

HKL target = 0x0412; // Korean
bool is_target = false;
int i = 0
do {
	if (*(pKBList + i) == Target) {
		IsTarget = true;
		break;
	}
} while(i < nKBList);
```


## GetUserDefaultLangID

### Concept

- GetUserDefaultLangID
	- í˜„ì¬ ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •ëœ LANGIDë¥¼ ë°˜í™˜
- ì‹¤í–‰ íë¦„
	1. GetUserDefaultLangIDë¥¼ í˜¸ì¶œí•˜ì—¬ lcidë¥¼ íšë“.
	2. ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ íƒ€ê²Ÿì¸ì§€ í™•ì¸.

### GetUserDefaultLangID

```C++
LANGID GetUserDefaultLangID();
```

### Example

```C++
bool is_target = false;
LANGID lcid = GetUserDefaultLangID();

if (lcid == 0x412) {
	is_target = true;
}
```


## GetLocaleInfoA

### Concept

- GetLocaleInfoA
	- LCID ê°’ì„ ì „ë‹¬í•˜ë©´ ì–¸ì–´ëª…ì„ íšë“ ê°€ëŠ¥
- ì‹¤í–‰ íë¦„
	1. GetUserDefaultLangID ë“±ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ LCIDë¥¼ íšë“.
	2. LCIDë¥¼ GetLocaleInfoAì— ì „ë‹¬í•˜ì—¬ ì–¸ì–´ëª…ì„ íšë“.
	3. ì–¸ì–´ëª…ì„ ì„œë²„ë¡œ ì „ë‹¬.

### GetLocaleInfoA

```C++
int GetLocaleInfoA(
  [in]            LCID   Locale,
  [in]            LCTYPE LCType,
  [out, optional] LPSTR  lpLCData,
  [in]            int    cchData
);
```

| ***LCTYPE***     | ***value*** | ***Info***       |
| ---------------- | ----------- | ---------------- |
| LOCALE_SLANGUAGE | 0x2         | ë¯¸ë¦¬ ì •ì˜ëœ lcidì˜ ì–¸ì–´ëª… |

### Example

```C++
char buf[260];
LANGID lcid = GetUserDefaultLangID();
GetLocaleInfoA(lcid, LOCALE_SLANGUAGE, buf, sizeof(buf));
```


## Registry

### Concept

#### "HKU\\(SID)\\Control Panel\\International"

| Value Name | Example |
| ---------- | ------- |
| LocaleName | ko-KR   |
| sLanguage  | KOR     |

### Code Flow

1. RegCreateKeyExWë¥¼ ì‚¬ìš©í•˜ì—¬ "HKU\\(SID)\\Control Panel\\International" í‚¤ í•¸ë“¤ì„ íšë“
2. RegQueryValueExWë¥¼ ì‚¬ìš©í•˜ì—¬ "LocaleName", "sLanguage" í‚¤ ê°’ì„ í™•ì¸

### RegCreateKeyExW

```c++
LSTATUS RegCreateKeyExW(
  [in]            HKEY                        hKey,
  [in]            LPCWSTR                     lpSubKey,
                  DWORD                       Reserved,
  [in, optional]  LPWSTR                      lpClass,
  [in]            DWORD                       dwOptions,
  [in]            REGSAM                      samDesired,
  [in, optional]  const LPSECURITY_ATTRIBUTES lpSecurityAttributes,
  [out]           PHKEY                       phkResult,
  [out, optional] LPDWORD                     lpdwDisposition
);
```

### RegQueryValueExW

```c++
LSTATUS RegQueryValueExW(
  [in]                HKEY    hKey,
  [in, optional]      LPCWSTR lpValueName,
                      LPDWORD lpReserved,
  [out, optional]     LPDWORD lpType,
  [out, optional]     LPBYTE  lpData,
  [in, out, optional] LPDWORD lpcbData
);
```

### Example

```c++
RegCreateKeyExW(HKEY_USERS, "(SID)\\Control Panel\\International",
				0x0, 0x0, 0x0, 0x20119, 0x0, &h_key, 0x0);
type = REG_SZ;
data_size = 0x10;
RegQueryValueExW(h_key, "LocaleName", 0x0, &type, locale_name_ptr, &data_size);
RegQueryValueExW(h_key, "sLanguage", 0x0, &type, s_language_ptr, &data_size);
```