#com 
## 1. CoCreateInstance를 호출하여 IShellLinkA Interface 획득

### Code Flow

```C++
IShellLinkA *pIShellLinkA = null;
CoCreateInstance(&CLSID_Shortcut,NULL, CLSCTX_INPROC_SERVER,
				 &IID_IShellLinkA, (void**)&pIShellLinkA);
```

1.  Shortcut 관련 COM 객체를 사용하기 위해 CoCreateInstance에 다음 CLSID, IID를 전달
	- CLSID_Shortcut = {00021401-0000-0000-C000-000000000046}
	- IID_IShellLinkA = {000214EE-0000-0000-C000-000000000046}

### CoCreateInstance

```C++
HRESULT CoCreateInstance(
  [in]  REFCLSID  rclsid,
  [in]  LPUNKNOWN pUnkOuter,
  [in]  DWORD     dwClsContext,
  [in]  REFIID    riid,
  [out] LPVOID    *ppv
);
```


## 2. IPersistFile 인터페이스를 획득 후, 파일 객체를 획득

### Code Flow

```C++
IPersistFile *pIPersistFile = null;
pIShellLinkA->QueryInterface(&IID_IPersistFile, (void**)&pIPersistFile);

MultiByteToWideChar(0x0, 0x0, p_path, 0xffffffff, p_path_w, 0x104);
pIPersistFile->Load(p_path_w, STGM_READ);
pIShellLinkA->Resolve(0x0, SLR_NO_UI);
```

1. IShellLinkA::QueryInterface를 호출하여, IPersistFile 인터페이스를 획득
	- IID_IPersistFile = {0000010B-0000-0000-C000-000000000046}
2. 전달할 .lnk 파일의 경로가 wstr이 아니라면 MultiByteToWideChar로 wstr로 변경
3. IPersisFile::Load를 호출하여, .lnk 파일의 경로를 로드
4. IShellLinkA::Resolve를 호출하여, 로드된 .lnk 파일 객체를 찾음.

### IShellLinkA::QueryInterface

```C++
HRESULT QueryInterface(
  REFIID riid,
  void   **ppvObject
);
```

### IPersistFile::Load

```C++
HRESULT Load(
  [in] LPCOLESTR pszFileName,
  [in] DWORD     dwMode
);
```

### IShellLinkA::Resolve

```C++
HRESULT Resolve(
  HWND  hwnd,
  DWORD fFlags
);
```


## 3.  GetPath 함수를 호출하여, raw path를 획득

### Code Flow

```C++
pIShellLinkA->GetPath(p_raw_path, 0x104, null, SLGP_RAWPATH);
```

1. IShellLinkA::Resolve를 호출하여, raw path를 획득.

### IShellLinkA::Resolve

```C++
HRESULT GetPath(
  [out]     LPSTR            pszFile,
  [in]      int              cch,
  [in, out] WIN32_FIND_DATAA *pfd,
  [in]      DWORD            fFlags
);
```


## 4. Example

```C++
IShellLinkA *pIShellLinkA = null;
CoCreateInstance(&CLSID_Shortcut,NULL, CLSCTX_INPROC_SERVER,
				 &IID_IShellLinkA, (void**)&pIShellLinkA);

IPersistFile *pIPersistFile = null;
pIShellLinkA->QueryInterface(&IID_IPersistFile, (void**)&pIPersistFile);

MultiByteToWideChar(0x0, 0x0, p_path, 0xffffffff, p_path_w, 0x104);
pIPersistFile->Load(p_path_w, STGM_READ);
pIShellLinkA->Resolve(0x0, SLR_NO_UI);

pIShellLinkA->GetPath(p_raw_path, 0x104, null, SLGP_RAWPATH);


```