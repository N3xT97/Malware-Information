### Concept

악성 코드는 netspread를 위해 domain controller dns host name들을 획득하고자 한다.

### Code Flow

1. DsGetDcNameW API을 사용해 로컬 컴퓨터가 속한 도메인 컨트롤러의 정보 획득
2. 획득한 컨트롤러의 도메인을 전달해 DsGetDcOpenW API를 사용해 도메인 컨트롤러 열거 작업을 오픈
3. DsGetDcNextW API를 통해 순회

### Example

```c++
# 모든 DC의 dns host name을 획득
DsGetDcNameW(NULL, NULL, NULL, NULL, 0x0, &dci);
DsGetDcOpenW(dci->DomainName, 0x0, NULL, NULL, NULL, 0x0, &h_dc);
do {
    while (err = DsGetDcNextW(h_dc, 0x0, 0x0, &dc_dns_host_name), err == ERROR_SUCCESS) {
		swprintf(dc_dns_host_name_path, "\\%s\", dc_dns_host_name);
		dc_dns_host_name_table = dc_dns_host_name_path;
		NetApiBufferFree(dc_dns_host_name);
		n_table = n_table + 0x1;
		dc_dns_host_name_table = dc_dns_host_name_table + 0x1;
    }
} while (err != ERROR_NO_MORE_ITEMS && err == ERROR_FILEMARK_DETECTED);
DsGetDcCloseW(h_dc);
NetApiBufferFree(dci);
```