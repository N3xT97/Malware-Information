## RtlAdjustPrivilege

### RtlAdjustPrivilege

```c++
[DllImport("ntdll.dll", SetLastError = true)]
public static extern int RtlAdjustPrivilege(
   uint Privilege,
   bool Enable,
   bool CurrentThread,
   out bool Enabled
);
```

- bIsCurrentThread가 False라면 현재 프로세스, True라면 호출 스레드

### Privilege

| Value | Privilege                                 | Info                                                                                                                   |
| ----- | ----------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| 0x3   | SeAssignPrimaryTokenPrivilege             | 프로세스의 기본 토큰을 할당하는 데 필요.                                                                                                |
| 0x5   | SeIncreaseQuotaPrivilege                  | 프로세스에 할당된 할당량을 늘리는 데 필요.                                                                                               |
| 0x8   | SeSecurityPrivilege                       | 감사 메시지 제어 및 보기와 같은 여러 보안 관련 기능을 수행하는 데 필요.                                                                             |
| 0x9   | SeTakeOwnershipPrivilege                  | 임의 액세스 권한을 부여하지 않고 개체의 소유권을 가져와야 함. 이 권한을 통해 소유자 값은 소유자가 개체의 소유자로 합법적으로 할당할 수 있는 값으로만 설정할 수 있음. 파일 또는 기타 개체의 소유권을 가져옴. |
| 0xB   | SeSystemProfilePrivilege                  | 전체 시스템에 대한 프로파일링 정보를 수집하는 데 필요.                                                                                        |
| 0xD   | SeProfileSingleProcessPrivilege           | 단일 프로세스에 대한 프로파일링 정보를 수집하는 데 필요.                                                                                       |
| 0xE   | SeIncreaseBasePriorityPrivilege           | 프로세스의 기본 우선 순위를 늘리는 데 필요.                                                                                              |
| 0x11  | SeBackupPrivilege                         | 백업 작업을 수행하는 데 필요. 이 권한으로 인해 시스템은 파일에 대해 지정된 ACL(액세스 제어 목록)에 관계없이모든 파일에 대한 모든 읽기 액세스 제어를 부여함.                           |
| 0x12  | SeRestorePrivilege                        | 복원 작업을 수행하는 데 필요. 이 권한으로 인해 시스템에서 파일에 대해 지정된 ACL에 관계없이 모든 파일에 대한 모든 쓰기 액세스 제어를 부여함.                                    |
| 0x13  | SeShutdownPrivilege                       | 로컬 시스템을 종료하는 데 필요.                                                                                                     |
| 0x14  | SeDebugPrivilege                          | 다른 계정이 소유한 프로세스를 디버그하고 프로세스의 메모리를 조정하는 데 필요.                                                                           |
| 0x1C  | SeManageVolumePrivilege                   | 볼륨 관리 권한을 사용하도록 설정하는 데 필요.                                                                                             |
| 0x1D  | SeImpersonatePrivilege                    | 가장하는 데 필요. 인증 후 클라이언트를 가장함.                                                                                            |
| 0x21  | SeIncreaseWorkingSetPrivilege             | 사용자의 컨텍스트에서 실행되는 애플리케이션에 더 많은 메모리를 할당하는 데 필요.                                                                          |
| 0x24  | SeDelegateSessionUserImpersonatePrivilege | 동일한 세션에서 다른 사용자에 대한 가장 토큰을 가져오는 데 필요.                                                                                  |

### Example

```C++
RtlAdjustPrivilege(SeDebugPrivilege, 0x1, 0x0, &was_enabled);
```