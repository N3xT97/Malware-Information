### Concept

악성 코드는 Named Pipe를 사용하여 프로세스간 통신하기도 함.

### Code Flow

1. Send 프로세스에서 CreateNamedPipe를 호출하여 NamedPipe를 생성
2. Send 프로세스에서 ConnectNamedPipe를 호출하여 NamedPipe에 연결 대기
3. Send 프로세스에서 WriteFile을 호출하여 NamedPipe에 쓰기
4. Receive 프로세스에서 CreateFileW를 호출하여 NamedPipe에 연결 후 핸들을 획득
5. Receive 프로세스에서 ReadFile를 호출하여 NamedPipe를 읽음

### Example

```C++
# Send
h_pipe = CreateNamedPipeW("\\.\pip\example_pipe", PIPE_ACCESS_DUPLEX,
						  PIPE_TYPE_BYTE|PIPE_READMODE_BYTE|PIPE_WAIT, 
						  0xff, 0x0, 0x0, 0xffffffff, &sa);
ConnectNamedPipe(h_pipe, 0x0);
send_len = wcslen(send_buf);
WriteFile(h_pipe, send_buf, (send_len + 0x1) * 0x2, &ret_size, 0x0);
ZwClose(h_pipe);

# Receive
h_pipe = CreateFileW("\\.\pip\example_pipe", GENERIC_READ|GENERIC_WRITE,
					 FILE_SHARE_READ|FILE_SHARE_WRITE, NULL,
					 OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
ReadFile(h_pipe, receive_buf, receive_size, &ret_size, NULL);
ZwClose(h_pipe);
```