## 중단점 기반 탐지

디버거를 사용하여 프로세스를 분석하는 동안 다양한 종류의 중단점을 설정함. 멀웨어는 중단점을 사용할 때 나타나는 특징을 탐지하여 자신이 분석 환경에서 실행 중임을 추측할 수 있음.

### 소프트웨어 중단점 탐지

디버거에서 소프트웨어 중단점을 설정하면, 해당 위치의 명령을 `INT 3` 명령어로 대체함. 이때 `INT 3`의 명령어의 기계어 코드는 `0xCC` 또는 `0xCD03`임. 멀웨어는 소프트웨어 중단점을 식별하기 위해 전체 코드 블록에서 `0xCC`나 `0xCD03` 바이트를 검색함.

### 하드웨어 중단점 탐지

x86 시스템에서는 DR0-DR7 디버그 레지스터를 사용해 하드웨어 중단점을 설정함. CONTEXT 구조체에는 디버그 레지스터 DR0-DR7을 포함하는 스레드의 상태 정보를 갖고 있음. 멀웨어는 GetThradContext API를 사용하여 CONTEXT 구조체의 디버그 레지스터를 확인하여 자신이 분석 환경에서 실행 중인지 추측할 수 있음.

